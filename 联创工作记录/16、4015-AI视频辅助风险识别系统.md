# 1、方案

## 1.1、北小菜

代码地址： https://gitee.com/Vanishi/BXC_VideoAnalyzer_v4/

文档：https://beixiaocai.yuque.com/org-wiki-beixiaocai-vo72oa/xcms/69315a530fd4a0664d989be2618ca982

## 1.2、wgai

https://github.com/YeyuchenBa/wgai?tab=readme-ov-file

太杂

## 1.3、BrainFrame（科大讯飞）

https://www.xfyun.cn/solutions/video/?isZc=1

## 1.4、yolo-onnx-java
https://gitee.com/agricultureiot/yolo-onnx-java

## 1.5、JavaVision

https://github.com/javpower/JavaVision

耦合性太高


## 1.6、java_pytorch_onnx_tensorrt_yolov8_vue

https://github.com/xiaoyeshenger/java_pytorch_onnx_tensorrt_yolov8_vue?tab=readme-ov-file

SpringBoot+Docker+Cuda+Cudnn+Pythorch+Onnx+Tensorrt+Yolov8+ffmpeg+zlmediakit 的AI算法中台系统，本系统主要实现JAVA调用Python脚本的方式，实现在英伟达GPU上进行yolov8的onnx或tensorrt的推理运算，实现火灾烟雾等视频的识别，并将识别结果通过ffmpeg推流到zlmediakit流媒体服务器。


rocket启动


## 1.2、问题

# 2、部署video-analyzer

## 2.1、安装python3.9

1. 输入以下命令来安装依赖软件包：

```shell
# 安装依赖软件包：
sudo yum install -y gcc openssl-devel bzip2-devel libffi-devel
# 下载源码
wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tgz
# 解压
tar -xf Python-3.9.0.tgz
# 进入解压后目录
cd Python-3.9.0
# 配置和编译安装python
./configure --enable-optimizations
make && sudo make altinstall
# 查看状态
python3.9 --version
```

这将安装Python编译所需的一些依赖软件包。

4. 下载Python 3.9的源代码。你可以访问Python官方网站（python.org）或使用以下命令下载：

```apache
wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0.tgz
```

这将从Python官方网站下载Python 3.9的源代码压缩包。

5. 解压下载的源代码压缩包。使用以下命令解压：

```apache
tar -xf Python-3.9.0.tgz
```

6. 进入解压后的目录：

```apache
cd Python-3.9.0
```

7. 配置和编译Python。输入以下命令进行配置：

```jboss-cli
./configure --enable-optimizations
```

然后，输入以下命令编译并安装Python：

```gauss
make && sudo make altinstall
```

这将编译并安装Python 3.9，同时使用 `altinstall`选项来避免覆盖系统默认的Python版本。

8. 安装完成后，可以使用以下命令验证Python安装是否成功：

```vim
python3.9 --version
```

该命令应该显示Python 3.9的版本号。

现在，你已成功在CentOS 7上安装了Python 3.9。你可以使用 `python3.9`命令来运行Python 3.9解释器。

## 2.1、部署流媒体服务器Zlmediakit

安装Zlmediakit流媒体服务器，安装方法如下:

```shell
(1).拉取docker镜像
docker pull zlmediakit/zlmediakit:master

(2).创建目录以存放zlmediakit数据
mkdir -p /home/docker/zlmediakit && chmod 777 /home/docker/zlmediakit

(3).运行镜像
    --1.先运行镜像得到配置文件
    docker run --name zlmediakit -d zlmediakit/zlmediakit:master

    --2.复制 zlmediakit 容器文件到指定目录
    docker cp -a zlmediakit:/opt/media /home/docker/zlmediakit

    --3.删除 zlmediakit 容器
    docker rm -f zlmediakit

    --4.重新按自定义方式运行
    docker run --name zlmediakit --restart=always --env MODE=standalone -e TZ="Asia/Shanghai" \
        -v /home/docker/zlmediakit/media/bin:/opt/media/bin \
        -v /home/docker/zlmediakit/media/conf:/opt/media/conf \
        -p 11935:1935 -p 11080:80 -p 11554:554 \
        -p 11000:10000 -p 11000:10000/udp -p 18000:8000/udp \
        -p 50000-50300:50000-50300/udp \
        -d zlmediakit/zlmediakit:master
```

## 2.2、模拟推流

```shell
ffmpeg -re -stream_loop -1  -i test.mp4  -rtsp_transport tcp -c copy -f rtsp rtsp://192.168.7.92:11554/live/test
```
