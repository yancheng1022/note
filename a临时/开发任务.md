# 1、温度曲线

1. 增加监测时间format字段

```sql
ALTER TABLE ims_instrument_temperature_202308 ADD monitor_time_format datetime  COMMENT '监测时间'
```


2. 时间戳转时间

```sql
UPDATE ims_instrument_temperature_202308
SET monitor_time_format = FROM_UNIXTIME(monitor_time/1000,'%Y-%m-%d %H:%i:%s');
```


3. 修改分表逻辑后数据重新分配逻辑：InstrumentTemperatureHandlerTest
4. 结果比对
```sql
SELECT SUM(total) AS total_sum FROM (
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202301
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202302
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202303
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202304
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202305
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202306
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202307
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202308
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202309
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_202310
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_temp_200001
) AS totals;


SELECT SUM(total) AS total_sum FROM (
  SELECT count(*) AS total FROM ims_test_sample_fetch_202301
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202302
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202303
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202304
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202305
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202306
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202307
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202308
  UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202309
UNION ALL
  SELECT count(*) AS total FROM ims_test_sample_fetch_202310

) AS totals;
```


4. 添加仪器温度位置字典


# 2、分表逻辑调整
## 2.1、ims_sample_base
1. 添加字段

```sql
ALTER TABLE ims_sample_base ADD submit_work_time datetime  COMMENT '提交工单时间'
```

2. 需要清洗字段：submit_work_time,sample_uid
## 2.2、ims_test_result

1. 添加索引

```sql
create index SUBMIT_WORK_TIME_INDEX on ims_test_result(submit_work_time);
```

2. 修改字段长度
```sql
alter table ims_test_result_202301 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202302 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202303 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202304 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202305 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202306 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202307 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202308 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_202309 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_2023010 modify column  work_uid  VARCHAR(255);
alter table ims_test_result_2023011 modify column  work_uid  VARCHAR(255);
```
1. 清洗字段：sample_uid,test_uid
## 2.3、ims_work_result

1. 清洗字段：test_uids，sample_uid,add_task_time,submit_work_time,test_ids,uid
2. 修改uid字段为varchar类型
```sql
ALTER TABLE ims_work_result CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_200001 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202301 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202302 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202303 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202304 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202305 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202306 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202307 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202308 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202309 CHANGE  uid uid VARCHAR(255);
ALTER TABLE ims_work_result_202310 CHANGE  uid uid VARCHAR(255);
```

关联测试id？？？？

## 2.4、ims_test_sample_fetch

1. 添加submit_work_time字段

```sql
alter table ims_test_sample_fetch add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202301 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202302 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202303 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202304 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202305 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202306 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202307 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202308 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202309 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202310 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_fetch_202311 add column submit_work_time datetime default null COMMENT '工单提交时间';
```

## 2.5、ims_test_sample_diluent

1. 添加字段

```sql
alter table ims_test_sample_diluent add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202301 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202302 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202303 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202304 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202305 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202306 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202307 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202308 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202309 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202310 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_sample_diluent_202311 add column submit_work_time datetime default null COMMENT '工单提交时间';
```
## 2.6、ims_test_reagent_add

1. 添加字段

```sql
alter table ims_test_reagent_add add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202301 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202302 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202303 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202304 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202305 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202306 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202307 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202308 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202309 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202310 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_reagent_add_202311 add column submit_work_time datetime default null COMMENT '工单提交时间';
```
## 2.7、ims_test_incubate

1. 加字段

```sql
alter table ims_test_incubate add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202301 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202302 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202303 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202304 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202305 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202306 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202307 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202308 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202309 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202310 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_incubate_202311 add column submit_work_time datetime default null COMMENT '工单提交时间';
```
## 2.8、ims_test_ls_add

1. 加字段

```sql
alter table ims_test_ls_add add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202301 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202302 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202303 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202304 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202305 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202306 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202307 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202308 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202309 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202310 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_ls_add_202311 add column submit_work_time datetime default null COMMENT '工单提交时间';
```

## 2.9、ims_test_read

1. 加字段

```sql
alter table ims_test_read add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202301 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202302 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202303 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202304 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202305 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202306 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202307 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202308 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202309 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202310 add column submit_work_time datetime default null COMMENT '工单提交时间';
alter table ims_test_read_202311 add column submit_work_time datetime default null COMMENT '工单提交时间';
```




# 3、质控图
1. 客户名称查询改编码
2. 查询条件 区域，省份，仪器负责人，质控品编号需要补充

# 4、质控数据
1. 增加测试方法字段

{"assayCode":"","engineer":"","startTime":"2023-08-01","endTime":"2023-08-16","reagentLot":"","commonReagentLot":""}

var json = {};  
$.each($("#formId").serializeArray(), function(i, field) {  
    if(json[field.name]) {  
        json[field.name] += ("," + field.value);  
    } else {  
        json[field.name] = field.value;  
    }  
});
localStorage.setItem("qcParams", JSON.stringify(json));
这段代码我获取表单中数据存储到localstorage，但是多选下拉数据没有获取到，我该怎么改进

