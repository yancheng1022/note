vpn登录信息&堡垒机登录信息&服务器信息  
https://docs.qq.com/sheet/DQm1HTm1SaXphQkxi?no_promotion=1&tab=BB08J2  
  
##### 中燃测试环境  
## 系统登录  
https://testaicc.chinagasholdings.com/#/channelLogin  
企业ID&账号&密码：  
ITGZT \ admin \ WElljoint@210908  
LPG \ admin \ WElljoint@210908  
  
## gls登录账密  
https://testaicc.chinagasholdings.com/gls/login  
HYCC / WElljoint@210908  
  
## nacos  
http://172.25.1.46:8848/nacos  
nacos / hytx@admin!@#  
  
##### 中燃生产环境  
外网https访问：  
地址：https://aicc.chinagasholdings.com/#/channelLogin  
企业ID&账号&密码：  
ITGZT \ admin \ WElljoint@210908  
LPG \ admin \ WElljoint@210908  
外网内网http访问：  
地址：http://aicc.chinagasholdings.com/#/channelLogin  
企业ID&账号&密码：  
ITGZT \ admin \ WElljoint@210908  
LPG \ admin \ WElljoint@210908  
内网ip访问：  
地址：http://172.25.1.68/#/channelLogin  
企业ID&账号&密码：  
ITGZT \ admin \ WElljoint@210908  
LPG \ admin \ WElljoint@210908  
  
## gls登录账密  
https://aicc.chinagasholdings.com/gls  
HYCC / WElljoint@210908  
  
## nacos  
http://172.25.1.65:8848/nacos  
nacos / hytx@admin!@#

# 0、环境地址信息

## 0.1、vpn

VPN:用IE浏览器输入服务器地址：116.31.111.59  
下载SSL VPN客户端
wf/Gas#*20200858

## 0.2、数据同步相关
"智能呼叫中心系统"SOA测试环境使用账号/密码：  
     账号：OSB_DEV_AICC  
     密码：AiccWx2#86  
 "智能呼叫中心系统"SOA正式环境使用账号/密码：  
     账号：OSB_PRD_AICC  
     密码：AiccPrdSq9#86  
请注意信息安全，保管好账号密码


|               |                                                                                                                                                         |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SOA服务地址（测试环境） | [http://172.26.0.137:6011/services/2F06402000001](http://172.26.0.137:6011/services/2F06402000001)<br><br>_鉴权账号密码需要应用方自行向SOA申请_                         |
| SOA服务地址（生产环境） | [http://soa.chinagasholdings.com:7011/services/2F06402000001](http://soa.chinagasholdings.com:7011/services/2F06402000001)<br><br>_鉴权账号密码需要应用方自行向SOA申请_ |

## 0.4、堡垒机
堡垒机地址：https://cbh.chinagasholdings.com/  
yanshaowei  
c@ZSdqycB#1

172.25.1.47  数据库 ，  在主机上输入以下命令   connect db      就能进数据库命令行 hycca_3.0
42主机  应用服务器


## 0.5、租户
KFZX
LPG
ITGZT（IT工作台）

## 0.6、测试环境
https://testaicc.chinagasholdings.com/#/channelLogin
KFZX/8002/2wsx@WSX
KFZX/guoyc/c@ZSdqycB#1

登录VPN后访问http://172.25.1.46:8848/nacos  
账号：nacos  
密码：hytx@admin!@#

## 0.7、crm
https://uatcrm.chinagasholdings.com/cgcrm
hjxm
Gas*1234

# 1、应用系统集成

身份主数据分发（员工、机构、岗位）
开通/回收应用系统账号
单点登录集成


# 2、IMA身份主数据定时同步集成规范

1.身份主数据接口服务
http://172.26.0.137:6011/services/2F06402000001    鉴权账号密码需要应用方自行向SOA申请（Basic Auth的鉴权方式）

（1）人员接口字段（RYXX）
（2）组织（部门）接口字段（ZZJG）
（3）人员组织关系接口字段（RYZZGX）
（4）职务（岗位）接口字段（MDM_RYZW_QUERY）
（5）组织-流程角色（LCJS）





# 3、短信
### 6.1.1、sql

```sql
INSERT INTO `hycca_3.0`.`sms_entid_gateway` (`entId`, `company_name`, `gateway_id`, `is_default`)
VALUES
('ITGZT', 'IT工作台', 111, 0);

INSERT INTO `hycca_3.0`.`sms_gateway_config` (`sms_company`, `send_type`, `url`, `data`) VALUES ('中燃-孝感', 'SendMessageZRQServiceImpl', 'https://cjdsm.chinagasholdings.com/api/open-api/v2/text/task/create', '{\"accesskey\":\"c2k26U8XBSly7hh4BZdzXXjk1wkGKMgQ\",\"secret\":\"Ptsty0BPsjJckwQOyW2eOJP0W85EQYRDfpsJ6SSHvBXGB6AhKNplXmD4gLM7Q5KY\",\"groupCount\":\"100\"}');

INSERT INTO `hycca_3.0`.`sms_gateway_config` (`sms_company`, `send_type`, `url`, `data`) VALUES ( '中燃-芜湖', 'SendMessageZRQServiceImpl', 'https://cjdsm.chinagasholdings.com/api/open-api/v2/text/task/create', '{\"accesskey\":\"I0XDZ9XKEyNALYkYXMluzbsiO4YTbFSx\",\"secret\":\"oa3rf75uYFm9Kh5m8UxK6O492Na6QHhNo6GJGIaIYya1Gstws2quiJtkCcARO5Gb\",\"groupCount\":\"100\"}');

INSERT INTO `hycca_3.0`.`sms_entid_gateway` (`entId`, `company_name`, `gateway_id`, `is_default`)
VALUES
('ITGZT', 'IT工作台', 111, 0);
```
【中国燃气】您的短信验证码为:1234，该验证码在1分钟内有效，请您尽快完成操作（中燃集团–举报中心）
### 6.1.2、网关参数

```sql
-- 孝感
{"accesskey":"c2k26U8XBSly7hh4BZdzXXjk1wkGKMgQ","secret":"Ptsty0BPsjJckwQOyW2eOJP0W85EQYRDfpsJ6SSHvBXGB6AhKNplXmD4gLM7Q5KY"}
-- 芜湖
{"accesskey":"MfvnTfhyKIgggT6eRfCj6VXGs2aZPIYV","secret":"OcaHWZbrBu3tPbX3TvqNHuMCMNFJkuY6iEI4B4QfmjLLInjpyyKwldFRKk5ZVXgr"}
```
# 4、组织架构同步

加密请求： {"applicationCode":"AICC","batch":"","batchHistory":"","endTime":"2025/10/29 13:33:01","ifaceCode":"RYXX","pageNumber":0,"startTime":"1900/10/27 00:00:00"}

完整请求：{"applicationCode":"AICC","auth":"AICC","batch":"","ifaceCode":"RYXX","requestData":"eyJhcHBsaWNhdGlvbkNvZGUiOiJBSUNDIiwiaWZhY2VDb2RlIjoiUllYWCIsInN0YXJ0VGltZSI6IjIwMTUtMTAtMjcgMDA6MDA6MDAiLCJlbmRUaW1lIjoiMjAyNS0xMC0yOSAxMzozMzowMSIsImJhdGNoIjoiIiwiYmF0Y2hIaXN0b3J5IjoiIiwicGFnZU51bWJlciI6MCwicGFnZVNpemUiOjEwMDAsImRlcHRJZCI6bnVsbCwiZW1wSWQiOm51bGwsIm9yZ0NvZGUiOm51bGwsInBhcmVudERlcElkIjpudWxsLCJsYXN0dXBkYXRlZHRpbWUiOm51bGx9"}
### 6.2.1、sql
```sql
CREATE TABLE `iam_sync_batch` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `sync_status` tinyint(4) DEFAULT '0' COMMENT '状态: 0-同步成功, 1-同步失败',
  `start_time` datetime DEFAULT NULL COMMENT '开始时间',
  `end_time` datetime DEFAULT NULL COMMENT '结束时间',
  `created_time` datetime DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_time` datetime DEFAULT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='IAM同步批次信息表';

CREATE TABLE `iam_sys_dept` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '部门编号',
  `dept_id` varchar(100) NOT NULL COMMENT 'iam部门编号',
  `dept_pid` varchar(100) NOT NULL COMMENT 'iam父部门编号',
  `dept_name` varchar(32) NOT NULL COMMENT 'iam部门名称',
  `status` tinyint(1) unsigned DEFAULT '0' COMMENT '部门状态 默认0（0-启用 1-停用）',
  `company_id` varchar(32) DEFAULT NULL COMMENT '公司id',
  `company_name` varchar(32) DEFAULT NULL COMMENT '公司名称',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_time` datetime DEFAULT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE KEY `idx_dept_id_unique` (`dept_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `iam_sys_user` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '用户编号',
  `iam_empid` varchar(100) DEFAULT NULL COMMENT 'IAM人员账号',
  `iam_empname` varchar(100) DEFAULT NULL COMMENT 'IAM人员名称',
  `iam_deptid` varchar(100) DEFAULT NULL COMMENT 'IAM部门id',
  `iam_depname` varchar(100) DEFAULT NULL COMMENT 'IAM部门名称',
  `iam_dept_parent` varchar(100) DEFAULT NULL COMMENT 'IAM父组织机构ID',
  `iam_rolename` varchar(100) DEFAULT NULL COMMENT 'IAM角色编码',
  `iam_roledescr` varchar(100) DEFAULT NULL COMMENT 'IAM角色描述',
  `entid` varchar(100) DEFAULT NULL COMMENT '租户id',
  `status` varchar(10) DEFAULT '0' COMMENT '状态（0-启用，1-停用）',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_time` datetime DEFAULT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_iam_empid_unique` (`iam_empid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
```

### 6.2.2、nacos配置
```txt
iam:
  sync:
    cron: 0 */30 * * * ?
    applicationCode: AICC
    soaUrl: http://soa.chinagasholdings.com:7011/services/2F06402000001
    authUserName: OSB_PRD_AICC
    authPassword: AiccPrdSq9#86
    defaultPassword: Zr@123456
    defaultRoleId: 1
```


完成中燃租户分配、 短信网关对接功能、然后把扫描出来的严重漏洞改完了
先和前端联调一下租户分配功能（1天）中燃代码扫描还有十几个安全漏洞需要改一下（1天）

城燃行政组织架构：
集团  01
区域管理中心02
东北区域经营管理中心 03
经管中心 07
项目公司 04
- 分子公司（本质上也是项目公司）05
- 网格 06

燃气用户与组织管理：
org no：用户管理组织（360视图：所属网格/组织）
prj prg no：管理组织（360视图：项目公司）

# 5、停气公告
停气信息管理（停气管理的页签）：
①　把CRM的停气信息（项目公司人员登录CRM操作的停气数据）同步过来话务系统；
②　班组长有权登记停气
③　操作状态：新增、修改、删除
④　录入时实际恢复时间等于计划恢复时间
⑤　根据实际恢复时间，判断是否过期；
⑥　新增界面，有发布按钮。发布直接推送到IVR，进行语音播报
⑦　增加当前时间，或者历史时间段内的数据查询；
⑧　停气数据取自当前钉钉停气登记表；
⑨　最终效果：需要项目公司可以在新系统中进行录入，在相关界面同步展示当前停气情况数据 
停气信息管理，可以添加一个呼叫中心上传IVR字段，如果选择上传，可以配置IVR播报内容。
停气ivr:需要对停气影响户做判断设置(户数设定可自行设置)，如果停气影响户大于设定值，且项目公司没有发送停气ivr，需要将此停气信息推送给班组长，由组长手动发送ivr。
  停气列表加入ivr按键，ivr发送内容自动带入对应停气信息。


# 6、问题
1、原型里的停气类型和crm里的对应不上 
2、新增里的预计结束时间就是预计恢复时间吧？停气恢复时间是指实际恢复时间吗？
3、上传人（停气通知人？操作人工号？实施人？）



# 99、更新

docker cp hy-shortmessage:/app/hy-shortmessage.jar /data/crm01/yc/back/

cd /data/crm01/yc

docker cp hy-shortmessage.jar hy-shortmessage:/app/

日志：
docker logs --since='2025-11-24T19:20:00' --until='2025-11-24T19:24:00' dc3 > /data/crm01/log.txt


select * from kfzx_sms_default_config



60.10.135.210:63083/zr-data-sync-image:2025r2

# 